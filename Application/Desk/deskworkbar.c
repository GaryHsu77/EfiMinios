#include <includes.h>

const UINT8 DeskWorkbarName[]="WORKBAR";

const UINT8 DeskWorkbarStart[]="start";
const UINT8 DeskWorkbarStartBmp[]={
0x42, 0x4D, 0x56, 0x7, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x36, 0x4, 0x0, 0x0, 0x28, 0x0, 0x0, 0x0, 0x1E, 0x0, 0x0, 0x0, 0x19, 0x0, 0x0, 0x0, 0x1, 0x0, 0x8, 0x0, 0x0, 0x0, 0x0, 0x0, 0x20, 0x3, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x80, 0x0, 0x0, 0x80, 0x0, 0x0, 0x0, 0x80, 0x80, 0x0, 0x80, 0x0, 0x0, 0x0, 0x80, 0x0, 0x80, 0x0, 0x80, 0x80, 0x0, 0x0, 0xC0, 0xC0, 0xC0, 0x0, 0xC0, 0xDC, 0xC0, 0x0, 0xF0, 0xCA, 0xA6, 0x0, 0x0, 0x20, 0x40, 0x0, 0x0, 0x20, 0x60, 0x0, 0x0, 0x20, 0x80, 0x0, 0x0, 0x20, 0xA0, 0x0, 0x0, 0x20, 0xC0, 0x0, 0x0, 0x20, 0xE0, 0x0, 0x0, 0x40, 0x0, 0x0, 0x0, 0x40, 0x20, 0x0, 0x0, 0x40, 0x40, 0x0, 0x0, 0x40, 0x60, 0x0, 0x0, 0x40, 0x80, 0x0, 0x0, 0x40, 0xA0, 0x0, 0x0, 0x40, 0xC0, 0x0, 0x0, 0x40, 0xE0, 0x0, 0x0, 0x60, 0x0, 0x0, 0x0, 0x60, 0x20, 0x0, 0x0, 0x60, 0x40, 0x0, 0x0, 0x60, 0x60, 0x0, 0x0, 0x60, 0x80, 0x0, 0x0, 0x60, 0xA0, 0x0, 0x0, 0x60, 0xC0, 0x0, 0x0, 0x60, 0xE0, 0x0, 0x0, 0x80, 0x0, 0x0, 0x0, 0x80, 0x20, 0x0, 0x0, 0x80, 0x40, 0x0, 0x0, 0x80, 0x60, 0x0, 0x0, 0x80, 0x80, 0x0, 0x0, 0x80, 0xA0, 0x0, 0x0, 0x80, 0xC0, 0x0, 0x0, 0x80, 0xE0, 0x0, 0x0, 0xA0, 0x0, 0x0, 0x0, 0xA0, 0x20, 0x0, 0x0, 0xA0, 0x40, 0x0, 0x0, 0xA0, 0x60, 0x0, 0x0, 0xA0, 0x80, 0x0, 0x0, 0xA0, 0xA0, 0x0, 0x0, 0xA0, 0xC0, 0x0, 0x0, 0xA0, 0xE0, 0x0, 0x0, 0xC0, 0x0, 0x0, 0x0, 0xC0, 0x20, 0x0, 0x0, 0xC0, 0x40, 0x0, 0x0, 0xC0, 0x60, 0x0, 0x0, 0xC0, 0x80, 0x0, 0x0, 0xC0, 0xA0, 0x0, 0x0, 0xC0, 0xC0, 0x0, 0x0, 0xC0, 0xE0, 0x0, 0x0, 0xE0, 0x0, 0x0, 0x0, 0xE0, 0x20, 0x0, 0x0, 0xE0, 0x40, 0x0, 0x0, 0xE0, 0x60, 0x0, 0x0, 0xE0, 0x80, 0x0, 0x0, 0xE0, 0xA0, 0x0, 0x0, 0xE0, 0xC0, 0x0, 0x0, 0xE0, 0xE0, 0x0, 0x40, 0x0, 0x0, 0x0, 0x40, 0x0, 0x20, 0x0, 0x40, 0x0, 0x40, 0x0, 0x40, 0x0, 0x60, 0x0, 0x40, 0x0, 0x80, 0x0, 0x40, 0x0, 0xA0, 0x0, 0x40, 0x0, 0xC0, 0x0, 0x40, 0x0, 0xE0, 0x0, 0x40, 0x20, 0x0, 0x0, 0x40, 0x20, 0x20, 0x0, 0x40, 0x20, 0x40, 0x0, 0x40, 0x20, 0x60, 0x0, 0x40, 0x20, 0x80, 0x0, 0x40, 0x20, 0xA0, 0x0, 0x40, 0x20, 0xC0, 0x0, 0x40, 0x20, 0xE0, 0x0, 0x40, 0x40, 0x0, 0x0, 0x40, 0x40, 0x20, 0x0, 0x40, 0x40, 0x40, 0x0, 0x40, 0x40, 0x60, 0x0, 0x40, 0x40, 0x80, 0x0, 0x40, 0x40, 0xA0, 0x0, 0x40, 0x40, 0xC0, 0x0, 0x40, 0x40, 0xE0, 0x0, 0x40, 0x60, 0x0, 0x0, 0x40, 0x60, 0x20, 0x0, 0x40, 0x60, 0x40, 0x0, 0x40, 0x60, 0x60, 0x0, 0x40, 0x60, 0x80, 0x0, 0x40, 0x60, 0xA0, 0x0, 0x40, 0x60, 0xC0, 0x0, 0x40, 0x60, 0xE0, 0x0, 0x40, 0x80, 0x0, 0x0, 0x40, 0x80, 0x20, 0x0, 0x40, 0x80, 0x40, 0x0, 0x40, 0x80, 0x60, 0x0, 0x40, 0x80, 0x80, 0x0, 0x40, 0x80, 0xA0, 0x0, 0x40, 0x80, 0xC0, 0x0, 0x40, 0x80, 0xE0, 0x0, 0x40, 0xA0, 0x0, 0x0, 0x40, 0xA0, 0x20, 0x0, 0x40, 0xA0, 0x40, 0x0, 0x40, 0xA0, 0x60, 0x0, 0x40, 0xA0, 0x80, 0x0, 0x40, 0xA0, 0xA0, 0x0, 0x40, 0xA0, 0xC0, 0x0, 0x40, 0xA0, 0xE0, 0x0, 0x40, 0xC0, 0x0, 0x0, 0x40, 0xC0, 0x20, 0x0, 0x40, 0xC0, 0x40, 0x0, 0x40, 0xC0, 0x60, 0x0, 0x40, 0xC0, 0x80, 0x0, 0x40, 0xC0, 0xA0, 0x0, 0x40, 0xC0, 0xC0, 0x0, 0x40, 0xC0, 0xE0, 0x0, 0x40, 0xE0, 0x0, 0x0, 0x40, 0xE0, 0x20, 0x0, 0x40, 0xE0, 0x40, 0x0, 0x40, 0xE0, 0x60, 0x0, 0x40, 0xE0, 0x80, 0x0, 0x40, 0xE0, 0xA0, 0x0, 0x40, 0xE0, 0xC0, 0x0, 0x40, 0xE0, 0xE0, 0x0, 0x80, 0x0, 0x0, 0x0, 0x80, 0x0, 0x20, 0x0, 0x80, 0x0, 0x40, 0x0, 0x80, 0x0, 0x60, 0x0, 0x80, 0x0, 0x80, 0x0, 0x80, 0x0, 0xA0, 0x0, 0x80, 0x0, 0xC0, 0x0, 0x80, 0x0, 0xE0, 0x0, 0x80, 0x20, 0x0, 0x0, 0x80, 0x20, 0x20, 0x0, 0x80, 0x20, 0x40, 0x0, 0x80, 0x20, 0x60, 0x0, 0x80, 0x20, 0x80, 0x0, 0x80, 0x20, 0xA0, 0x0, 0x80, 0x20, 0xC0, 0x0, 0x80, 0x20, 0xE0, 0x0, 0x80, 0x40, 0x0, 0x0, 0x80, 0x40, 0x20, 0x0, 0x80, 0x40, 0x40, 0x0, 0x80, 0x40, 0x60, 0x0, 0x80, 0x40, 0x80, 0x0, 0x80, 0x40, 0xA0, 0x0, 0x80, 0x40, 0xC0, 0x0, 0x80, 0x40, 0xE0, 0x0, 0x80, 0x60, 0x0, 0x0, 0x80, 0x60, 0x20, 0x0, 0x80, 0x60, 0x40, 0x0, 0x80, 0x60, 0x60, 0x0, 0x80, 0x60, 0x80, 0x0, 0x80, 0x60, 0xA0, 0x0, 0x80, 0x60, 0xC0, 0x0, 0x80, 0x60, 0xE0, 0x0, 0x80, 0x80, 0x0, 0x0, 0x80, 0x80, 0x20, 0x0, 0x80, 0x80, 0x40, 0x0, 0x80, 0x80, 0x60, 0x0, 0x80, 0x80, 0x80, 0x0, 0x80, 0x80, 0xA0, 0x0, 0x80, 0x80, 0xC0, 0x0, 0x80, 0x80, 0xE0, 0x0, 0x80, 0xA0, 0x0, 0x0, 0x80, 0xA0, 0x20, 0x0, 0x80, 0xA0, 0x40, 0x0, 0x80, 0xA0, 0x60, 0x0, 0x80, 0xA0, 0x80, 0x0, 0x80, 0xA0, 0xA0, 0x0, 0x80, 0xA0, 0xC0, 0x0, 0x80, 0xA0, 0xE0, 0x0, 0x80, 0xC0, 0x0, 0x0, 0x80, 0xC0, 0x20, 0x0, 0x80, 0xC0, 0x40, 0x0, 0x80, 0xC0, 0x60, 0x0, 0x80, 0xC0, 0x80, 0x0, 0x80, 0xC0, 0xA0, 0x0, 0x80, 0xC0, 0xC0, 0x0, 0x80, 0xC0, 0xE0, 0x0, 0x80, 0xE0, 0x0, 0x0, 0x80, 0xE0, 0x20, 0x0, 0x80, 0xE0, 0x40, 0x0, 0x80, 0xE0, 0x60, 0x0, 0x80, 0xE0, 0x80, 0x0, 0x80, 0xE0, 0xA0, 0x0, 0x80, 0xE0, 0xC0, 0x0, 0x80, 0xE0, 0xE0, 0x0, 0xC0, 0x0, 0x0, 0x0, 0xC0, 0x0, 0x20, 0x0, 0xC0, 0x0, 0x40, 0x0, 0xC0, 0x0, 0x60, 0x0, 0xC0, 0x0, 0x80, 0x0, 0xC0, 0x0, 0xA0, 0x0, 0xC0, 0x0, 0xC0, 0x0, 0xC0, 0x0, 0xE0, 0x0, 0xC0, 0x20, 0x0, 0x0, 0xC0, 0x20, 0x20, 0x0, 0xC0, 0x20, 0x40, 0x0, 0xC0, 0x20, 0x60, 0x0, 0xC0, 0x20, 0x80, 0x0, 0xC0, 0x20, 0xA0, 0x0, 0xC0, 0x20, 0xC0, 0x0, 0xC0, 0x20, 0xE0, 0x0, 0xC0, 0x40, 0x0, 0x0, 0xC0, 0x40, 0x20, 0x0, 0xC0, 0x40, 0x40, 0x0, 0xC0, 0x40, 0x60, 0x0, 0xC0, 0x40, 0x80, 0x0, 0xC0, 0x40, 0xA0, 0x0, 0xC0, 0x40, 0xC0, 0x0, 0xC0, 0x40, 0xE0, 0x0, 0xC0, 0x60, 0x0, 0x0, 0xC0, 0x60, 0x20, 0x0, 0xC0, 0x60, 0x40, 0x0, 0xC0, 0x60, 0x60, 0x0, 0xC0, 0x60, 0x80, 0x0, 0xC0, 0x60, 0xA0, 0x0, 0xC0, 0x60, 0xC0, 0x0, 0xC0, 0x60, 0xE0, 0x0, 0xC0, 0x80, 0x0, 0x0, 0xC0, 0x80, 0x20, 0x0, 0xC0, 0x80, 0x40, 0x0, 0xC0, 0x80, 0x60, 0x0, 0xC0, 0x80, 0x80, 0x0, 0xC0, 0x80, 0xA0, 0x0, 0xC0, 0x80, 0xC0, 0x0, 0xC0, 0x80, 0xE0, 0x0, 0xC0, 0xA0, 0x0, 0x0, 0xC0, 0xA0, 0x20, 0x0, 0xC0, 0xA0, 0x40, 0x0, 0xC0, 0xA0, 0x60, 0x0, 0xC0, 0xA0, 0x80, 0x0, 0xC0, 0xA0, 0xA0, 0x0, 0xC0, 0xA0, 0xC0, 0x0, 0xC0, 0xA0, 0xE0, 0x0, 0xC0, 0xC0, 0x0, 0x0, 0xC0, 0xC0, 0x20, 0x0, 0xC0, 0xC0, 0x40, 0x0, 0xC0, 0xC0, 0x60, 0x0, 0xC0, 0xC0, 0x80, 0x0, 0xC0, 0xC0, 0xA0, 0x0, 0xF0, 0xFB, 0xFF, 0x0, 0xA4, 0xA0, 0xA0, 0x0, 0x80, 0x80, 0x80, 0x0, 0x0, 0x0, 0xFF, 0x0, 0x0, 0xFF, 0x0, 0x0, 0x0, 0xFF, 0xFF, 0x0, 0xFF, 0x0, 0x0, 0x0, 0xFF, 0x0, 0xFF, 0x0, 0xFF, 0xFF, 0x0, 0x0, 0xFF, 0xFF, 0xFF, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x0, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x0, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x1, 0x1, 0x1, 0xD, 0x1, 0x0, 0x0, 0x0, 0x0, 0xB, 0xD, 0x1, 0x1, 0x1, 0x0, 0x52, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x1, 0x1, 0x1, 0xD, 0xA, 0x0, 0xB, 0x1, 0x1, 0x1, 0x0, 0x0, 0x1, 0x1, 0x1, 0x1, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x1, 0x1, 0xE, 0xA, 0x0, 0x1, 0xF, 0xE, 0xE, 0xE, 0xD, 0x0, 0x0, 0xE, 0x1, 0x1, 0x0, 0x53, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x1, 0xD, 0xD, 0xF, 0x0, 0x1, 0xF, 0xE, 0xE, 0xD, 0xD, 0xE, 0x1, 0x0, 0x1, 0x1, 0x1, 0x1, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x1, 0xD, 0xE, 0x1, 0x0, 0xE, 0xE, 0xE, 0xE, 0xE, 0xE, 0xE, 0xE, 0x0, 0xB, 0xD, 0x1, 0x1, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0xD, 0xE, 0xF, 0x1, 0x0, 0xF, 0xE, 0xE, 0xF, 0xE, 0xE, 0xE, 0xE, 0xA, 0xA, 0xD, 0x1, 0x1, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0xD, 0xE, 0xF, 0xE, 0x0, 0xF, 0xF, 0xE, 0xE, 0xD, 0xE, 0xE, 0xE, 0x0, 0x1, 0xD, 0x1, 0x1, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0xD, 0xE, 0xE, 0xF9, 0x0, 0x1, 0xF9, 0xF, 0x1, 0xB, 0xE, 0xF, 0x1, 0x0, 0xE, 0x1, 0x1, 0x1, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0xD, 0xE, 0xE, 0xF9, 0x1, 0x0, 0xE, 0xF9, 0x1, 0x1, 0xF, 0xD, 0x0, 0xA, 0xE, 0x1, 0x1, 0x1, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0xF, 0xF, 0xF, 0xF9, 0x1, 0x0, 0xA, 0x1, 0xB, 0xA, 0x0, 0xA, 0xE, 0x1, 0x1, 0x1, 0x0, 0x53, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0xF, 0xF, 0xF9, 0xF, 0xF9, 0xE, 0xC, 0x1, 0xB, 0x1, 0x1, 0xE, 0xE, 0x1, 0x1, 0x1, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0xF9, 0xF, 0xF9, 0xF9, 0xF9, 0xF9, 0x1, 0xB, 0xF, 0xF, 0xD, 0xD, 0x1, 0x1, 0x0, 0x52, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0xD, 0xF9, 0xF, 0xF, 0xF, 0xF, 0xF, 0xE, 0xE, 0xE, 0xD, 0xD, 0x1, 0x1, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x1, 0xF9, 0xF9, 0xF, 0xF, 0xF, 0xE, 0xE, 0xF, 0xF, 0xF, 0xB, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0xB, 0xD, 0xF, 0xF, 0xF, 0xF, 0xF, 0xF9, 0xF, 0xF, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x0, 0xF9, 0xF, 0xF, 0xF9, 0xF, 0xF, 0x0, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x0, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x0, 0x0, 
};
UINT8 DeskWorkbarIcon[3];
UINT8 DeskWorkbarTime[9]="AM 00:00";
const UINT8 DeskWorkbarYear[]="YEAR  :";
const UINT8 DeskWorkbarMonth[]="MONTH :";
const UINT8 DeskWorkbarDate[]="DATE  :";
const UINT8 DeskWorkbarDay[]="DAY   :";
const UINT8 DeskWorkbarHour[]="HOUR  :";
const UINT8 DeskWorkbarMinute[]="MINUTE:";
const UINT8 DeskWorkbarSecond[]="SECOND:";

DESK_WORKBAR_CONTROL DeskWorkbarCtrl;

UINT8 DeskWorkbarBuffer[9];

VOID DeskWorkbarInit(VOID)
{
	//EFI_STATUS Status ;	
	
    DeskWorkbarCtrl.WindowListChange=FALSE;
    
    DeskWorkbarCtrl.TimePreviousMinute=0;
    DeskWorkbarCtrl.PreviousTime.Second=0;
    DeskWorkbarCtrl.PreviousTime.Minute=0;
    DeskWorkbarCtrl.PreviousTime.Hour=0;
    DeskWorkbarCtrl.PreviousTime.Day=0;
    DeskWorkbarCtrl.PreviousTime.Date=0;
    DeskWorkbarCtrl.PreviousTime.Month=0;
    DeskWorkbarCtrl.PreviousTime.Year=0;
    
    DeskWorkbarCtrl.CurrentTime.Second=0;
    DeskWorkbarCtrl.CurrentTime.Minute=0;
    DeskWorkbarCtrl.CurrentTime.Hour=0;
    DeskWorkbarCtrl.CurrentTime.Day=0;
    DeskWorkbarCtrl.CurrentTime.Date=0;
    DeskWorkbarCtrl.CurrentTime.Month=0;
    DeskWorkbarCtrl.CurrentTime.Year=0;
    
    DeskWorkbarCtrl.WorkBarGfx.BgColor=GFX_COLOR_DARKBLUE0;
    DeskWorkbarCtrl.WorkBarGfx.FgColor=GFX_COLOR_BLACK;
    DeskWorkbarCtrl.WorkBarGfx.FontColor=GFX_COLOR_WHITE;

    DeskWorkbarCtrl.WindowListHead=(WINDOW *)NULL;
    DeskWorkbarCtrl.WindowMemoryLength=DESK_WORKBAR_WINDOWAREA_W*DESK_WORKBAR_WINDOWAREA_H;
    DeskWorkbarCtrl.pWindowMemory=(EFI_GRAPHICS_OUTPUT_BLT_PIXEL *)(OsdCtrl.pPixMemory+(OsdCtrl.ScreenArea.H-DESK_WORKBAR_HEIGHT)*OsdCtrl.ScreenArea.W); 
    DeskWorkbarCtrl.TimeMonitor.Timer=1000;
    OsTimeTimerPut((OS_TIMER *)&DeskWorkbarCtrl.TimeMonitor);  
    
    //setup tables and devices
    WindowVariableInit(&DeskWorkbarCtrl.Window,WINDOW_TYPE_WORKBAR);
    DeskWorkbarCtrl.Window.pTitle=(UINT8 *)DeskWorkbarName;  
    DeskWorkbarCtrl.Window.UserTableList=(WINDOW_TABLE *)NULL;
    DeskWorkbarCtrl.Window.OutlineTable.Type=WINDOW_TABLE_OUTLINE; // no use in workbar
    DeskWorkbarCtrl.Window.OutlineTable.DeviceList=(WINDOW_DEVICE *)NULL;
    DeskWorkbarCtrl.Window.HeaderTable.Type=WINDOW_TABLE_HEADER;   // no use in workbar
    DeskWorkbarCtrl.Window.HeaderTable.DeviceList=(WINDOW_DEVICE *)NULL;
    DeskTableUserTableAdd(&DeskWorkbarCtrl.Window,&DeskWorkbarCtrl.StartTable);
    DeskTableUserTableAdd(&DeskWorkbarCtrl.Window,&DeskWorkbarCtrl.WindowListTable);
    DeskTableUserTableAdd(&DeskWorkbarCtrl.Window,&DeskWorkbarCtrl.TimeTable);
    
    DeskWorkbarCtrl.Window.DeviceArea.X=OsdCtrl.ScreenArea.X;
    DeskWorkbarCtrl.Window.DeviceArea.Y=OsdCtrl.ScreenArea.Y+OsdCtrl.ScreenArea.H-DESK_WORKBAR_HEIGHT;
    DeskWorkbarCtrl.Window.DeviceArea.W=OsdCtrl.ScreenArea.W;
    DeskWorkbarCtrl.Window.DeviceArea.H=DESK_WORKBAR_HEIGHT;
    DeskWorkbarCtrl.Window.DeviceDisplayArea.X=OsdCtrl.ScreenArea.X;
    DeskWorkbarCtrl.Window.DeviceDisplayArea.Y=OsdCtrl.ScreenArea.Y+OsdCtrl.ScreenArea.H-DESK_WORKBAR_HEIGHT;
    DeskWorkbarCtrl.Window.DeviceDisplayArea.W=OsdCtrl.ScreenArea.W;
    DeskWorkbarCtrl.Window.DeviceDisplayArea.H=DESK_WORKBAR_HEIGHT;       
    DeskWorkbarCtrl.Window.DisplayArea.X=OsdCtrl.ScreenArea.X;
    DeskWorkbarCtrl.Window.DisplayArea.Y=OsdCtrl.ScreenArea.Y+OsdCtrl.ScreenArea.H-DESK_WORKBAR_HEIGHT;
    DeskWorkbarCtrl.Window.DisplayArea.W=OsdCtrl.ScreenArea.W;
    DeskWorkbarCtrl.Window.DisplayArea.H=DESK_WORKBAR_HEIGHT;      

    DeskWorkbarCtrl.Window.Outline.Type=WINDOW_OUTLINE_GENERAL;
    DeskWorkbarCtrl.Window.Outline.OuterArea.X=0; // no outer area
    DeskWorkbarCtrl.Window.Outline.OuterArea.Y=0; // no outer area
    DeskWorkbarCtrl.Window.Outline.OuterArea.W=0; // no outer area
    DeskWorkbarCtrl.Window.Outline.OuterArea.H=0; // no outer area
    DeskWorkbarCtrl.Window.Outline.InnerArea.X=0; // no inner area
    DeskWorkbarCtrl.Window.Outline.InnerArea.Y=0; // no inner area
    DeskWorkbarCtrl.Window.Outline.InnerArea.W=0; // no inner area
    DeskWorkbarCtrl.Window.Outline.InnerArea.H=0; // no inner area
    DeskWorkbarCtrl.Window.OutlineTable.DeviceList=(WINDOW_DEVICE *)NULL;
    DeskWorkbarCtrl.Window.OutlineTable.Area.X=0; // no outline table area
    DeskWorkbarCtrl.Window.OutlineTable.Area.Y=0;
    DeskWorkbarCtrl.Window.OutlineTable.Area.W=0;
    DeskWorkbarCtrl.Window.OutlineTable.Area.H=0;
    DeskWorkbarCtrl.Window.HeaderTable.DeviceList=(WINDOW_DEVICE *)NULL;
    DeskWorkbarCtrl.Window.HeaderTable.Area.X=0; // no header table area
    DeskWorkbarCtrl.Window.HeaderTable.Area.Y=0;
    DeskWorkbarCtrl.Window.HeaderTable.Area.W=0;
    DeskWorkbarCtrl.Window.HeaderTable.Area.H=0;

    //user table initial for desk debug 
    DeskWorkbarCtrl.StartTable.Type=WINDOW_TABLE_GENERAL;
    DeskWorkbarCtrl.StartTable.DeviceList=(WINDOW_DEVICE *)NULL;
    DeskWorkbarCtrl.StartTable.Gfx.BgColor=GFX_COLOR_DARKBLUE0;
    DeskWorkbarCtrl.StartTable.Gfx.FgColor=GFX_COLOR_DARKBLUE0;
    DeskWorkbarCtrl.StartTable.Gfx.FontColor=GFX_COLOR_WHITE;
    DeskWorkbarCtrl.StartTable.Area.X=0;
    DeskWorkbarCtrl.StartTable.Area.Y=0;
    DeskWorkbarCtrl.StartTable.Area.W=(30+2); // "START"...5 char+2 edge for device+ 2 edge for device outside
    DeskWorkbarCtrl.StartTable.Area.H=DESK_WORKBAR_HEIGHT;
    DeskWorkbarCtrl.StartButton.Area.X=1;
    DeskWorkbarCtrl.StartButton.Area.Y=1;
    DeskWorkbarCtrl.StartButton.Area.W=30+2+2; // "start" 5 char + left edge + right edge
    DeskWorkbarCtrl.StartButton.Area.H=DESK_WORKBAR_HEIGHT-1;
    DeskWorkbarCtrl.StartButton.Type=WINDOW_BUTTON_PUSHBUTTON;
    DeskWorkbarCtrl.StartButton.Status=WINDOW_BUTTON_RELEASE;
    DeskWorkbarCtrl.StartButton.Active=TRUE;
    DeskWorkbarCtrl.StartButton.Outline=FALSE;
    DeskWorkbarCtrl.StartButton.pName=(UINT8*)DeskWorkbarStart;
    DeskWorkbarCtrl.StartButton.pBitmap=(UINT8 *)DeskWorkbarStartBmp;
    DeskWorkbarCtrl.StartButton.ReleaseGfx.BgColor=GFX_COLOR_DARKBLUE0;
    DeskWorkbarCtrl.StartButton.ReleaseGfx.FgColor=GFX_COLOR_DARKBLUE0;
    DeskWorkbarCtrl.StartButton.ReleaseGfx.FontColor=GFX_COLOR_WHITE;
    DeskWorkbarCtrl.StartButton.PressGfx.BgColor=GFX_COLOR_GREEN0;
    DeskWorkbarCtrl.StartButton.PressGfx.FgColor=GFX_COLOR_GREEN0;
    DeskWorkbarCtrl.StartButton.PressGfx.FontColor=GFX_COLOR_WHITE;
    DeskWorkbarCtrl.StartButton.InactiveGfx.BgColor=GFX_COLOR_LIGHTGRAY;
    DeskWorkbarCtrl.StartButton.InactiveGfx.FgColor=GFX_COLOR_LIGHTGRAY;
    DeskWorkbarCtrl.StartButton.InactiveGfx.FontColor=GFX_COLOR_BLUE;
    DeskWorkbarCtrl.WdStartButton.DeviceNumberLeft=DESK_WORKBAR_WD_STARTBUTTON;
    DeskWorkbarCtrl.WdStartButton.DeviceNumberMiddle=WINDOW_WDN_NULL;
    DeskWorkbarCtrl.WdStartButton.DeviceNumberRight=WINDOW_WDN_NULL;
    DeskWorkbarCtrl.WdStartButton.Type=WINDOW_DEVICE_BUTTON;
    DeskWorkbarCtrl.WdStartButton.pDevice=(UINT32 *)(&DeskWorkbarCtrl.StartButton);
    DeskTableWindowDeviceAdd(&DeskWorkbarCtrl.StartTable,&DeskWorkbarCtrl.WdStartButton);
    
    DeskWorkbarCtrl.TimeTable.Type=WINDOW_TABLE_GENERAL;
    DeskWorkbarCtrl.TimeTable.DeviceList=(WINDOW_DEVICE *)NULL;
    DeskWorkbarCtrl.TimeTable.Gfx.BgColor=GFX_COLOR_BLACK;
    DeskWorkbarCtrl.TimeTable.Gfx.FgColor=GFX_COLOR_BLACK;
    DeskWorkbarCtrl.TimeTable.Gfx.FontColor=GFX_COLOR_WHITE;
    DeskWorkbarCtrl.TimeTable.Area.X=DeskWorkbarCtrl.Window.DisplayArea.W-((8*12+2)+2);
    DeskWorkbarCtrl.TimeTable.Area.Y=0;
    DeskWorkbarCtrl.TimeTable.Area.W=8*12+2+2; // "AM 00:00"...8 char,2=2edges
    DeskWorkbarCtrl.TimeTable.Area.H=DESK_WORKBAR_HEIGHT;
    DeskWorkbarCtrl.TimeBox.Area.X=1;
    DeskWorkbarCtrl.TimeBox.Area.Y=8;
    DeskWorkbarCtrl.TimeBox.Area.W=8*12+2+1;
    DeskWorkbarCtrl.TimeBox.Area.H=DESK_WORKBAR_HEIGHT-1-1-1;
    DeskWorkbarCtrl.TimeBox.Type=WINDOW_STRINGBOX_GENERAL;
    DeskWorkbarCtrl.TimeBox.Dirty=FALSE;
    DeskWorkbarCtrl.TimeBox.Alignment=ALIGN_LEFT;
    DeskWorkbarCtrl.TimeBox.pName=DeskWorkbarTime;
    DeskWorkbarCtrl.TimeBox.Gfx.BgColor=GFX_COLOR_BLACK;
    DeskWorkbarCtrl.TimeBox.Gfx.FgColor=GFX_COLOR_BLACK;
    DeskWorkbarCtrl.TimeBox.Gfx.FontColor=GFX_COLOR_WHITE;
    DeskWorkbarCtrl.WdTimeBox.DeviceNumberLeft=DESK_WORKBAR_WD_TIMEBOX;
    DeskWorkbarCtrl.WdTimeBox.DeviceNumberMiddle=WINDOW_WDN_NULL;
    DeskWorkbarCtrl.WdTimeBox.DeviceNumberRight=WINDOW_WDN_NULL;
    DeskWorkbarCtrl.WdTimeBox.Type=WINDOW_DEVICE_STRINGBOX;
    DeskWorkbarCtrl.WdTimeBox.pDevice=(UINT32 *)(&DeskWorkbarCtrl.TimeBox);
    DeskTableWindowDeviceAdd(&DeskWorkbarCtrl.TimeTable,&DeskWorkbarCtrl.WdTimeBox);

    DeskWorkbarCtrl.WindowListTable.Type=WINDOW_TABLE_GENERAL;
    DeskWorkbarCtrl.WindowListTable.DeviceList=(WINDOW_DEVICE *)NULL;
    DeskWorkbarCtrl.WindowListTable.Gfx.BgColor=GFX_COLOR_DARKBLUE0;
    DeskWorkbarCtrl.WindowListTable.Gfx.FgColor=GFX_COLOR_DARKBLUE0;
    DeskWorkbarCtrl.WindowListTable.Gfx.FontColor=GFX_COLOR_WHITE;
    DeskWorkbarCtrl.WindowListTable.Area.X=DeskWorkbarCtrl.StartTable.Area.W;
    DeskWorkbarCtrl.WindowListTable.Area.Y=0;
    DeskWorkbarCtrl.WindowListTable.Area.W=DeskWorkbarCtrl.Window.DisplayArea.W
                                           -DeskWorkbarCtrl.StartTable.Area.W
                                           -DeskWorkbarCtrl.TimeTable.Area.W;
    DeskWorkbarCtrl.WindowListTable.Area.H=DESK_WORKBAR_HEIGHT;
 
    // add window to desk window list head
    DeskWindowWindowListHeadSet((WINDOW *)&DeskWorkbarCtrl.Window); 
}

VOID DeskWorkbarMemoryReset(VOID)
{
	//gBS->SetMem(DeskWorkbarCtrl.pWindowMemory, DeskWorkbarCtrl.WindowMemoryLength, GfxPaletteClut[GFX_COLOR_LIGHTBLUE4]);
	//GDB : Unused
}

VOID DeskWorkbarTimeUpdate(VOID){
    if((DeskWorkbarCtrl.PreviousTime.Second==DeskWorkbarCtrl.CurrentTime.Second)
     &&(DeskWorkbarCtrl.PreviousTime.Minute==DeskWorkbarCtrl.CurrentTime.Minute)
     &&(DeskWorkbarCtrl.PreviousTime.Hour==DeskWorkbarCtrl.CurrentTime.Hour)
     &&(DeskWorkbarCtrl.PreviousTime.Day==DeskWorkbarCtrl.CurrentTime.Day)
     &&(DeskWorkbarCtrl.PreviousTime.Date==DeskWorkbarCtrl.CurrentTime.Date)
     &&(DeskWorkbarCtrl.PreviousTime.Month==DeskWorkbarCtrl.CurrentTime.Month)
     &&(DeskWorkbarCtrl.PreviousTime.Year==DeskWorkbarCtrl.CurrentTime.Year)) return;
    DeskWorkbarCtrl.TimeWindowTimeDirty=TRUE;
    DeskWorkbarCtrl.CurrentTime.Second=DeskWorkbarCtrl.PreviousTime.Second;
    DeskWorkbarCtrl.CurrentTime.Minute=DeskWorkbarCtrl.PreviousTime.Minute;
    DeskWorkbarCtrl.CurrentTime.Hour=DeskWorkbarCtrl.PreviousTime.Hour;
    DeskWorkbarCtrl.CurrentTime.Day=DeskWorkbarCtrl.PreviousTime.Day;
    DeskWorkbarCtrl.CurrentTime.Date=DeskWorkbarCtrl.PreviousTime.Date;
    DeskWorkbarCtrl.CurrentTime.Month=DeskWorkbarCtrl.PreviousTime.Month;
    DeskWorkbarCtrl.CurrentTime.Year=DeskWorkbarCtrl.PreviousTime.Year;
}

VOID DeskWorkbarTimeDraw(VOID){
    UINT8 j;

    if(DeskWorkbarCtrl.TimePreviousMinute==DeskWorkbarCtrl.CurrentTime.Minute) return; //update per minute
    DeskWorkbarCtrl.TimePreviousMinute=DeskWorkbarCtrl.CurrentTime.Minute;
    // transfer time value to time string
    if(DeskWorkbarCtrl.CurrentTime.Hour<=0x12) DeskWorkbarTime[0]='A';
    else DeskWorkbarTime[0]='P';
    j=DeskWorkbarCtrl.CurrentTime.Hour;
    j=j&0x7f;
    DeskWorkbarTime[3]='0'+((j&0xf0)>>4);
    DeskWorkbarTime[4]='0'+(j&0x0f);
    j=DeskWorkbarCtrl.CurrentTime.Minute;
    DeskWorkbarTime[6]='0'+((j&0xf0)>>4);
    DeskWorkbarTime[7]='0'+(j&0x0f);
    DeskWorkbarTime[8]=0;
    DeskWorkbarCtrl.TimeBox.Dirty=TRUE;
    DeskDeviceStringboxDraw(DESK_DEVICE_DRAW_OSD,
                            &DeskWorkbarCtrl.Window,
                            &DeskWorkbarCtrl.TimeTable,
                            (WINDOW_STRINGBOX *)DeskWorkbarCtrl.WdTimeBox.pDevice);
}

VOID DeskWorkbarTimeWindowDraw(VOID)
{
    UINT8 j;
    
    if(DeskWorkbarCtrl.TimeWindowTimeDirty==FALSE) return; 
    DeskWorkbarCtrl.TimeWindowTimeDirty=FALSE;
    if(DeskTimeCtrl.Window.State==DESK_WINDOW_STATE_OFFDESK) return;
    //draw year
    BoardGotoxy(&DeskTimeCtrl.Board,1,1);
    BoardStringPrint(&DeskTimeCtrl.Board,(UINT8*)DeskWorkbarYear);
    j=DeskWorkbarCtrl.CurrentTime.Year;
    DeskWorkbarBuffer[0]='0'+((j&0xf0)>>4);
    DeskWorkbarBuffer[1]='0'+(j&0x0f);
    DeskWorkbarBuffer[2]=0;
    BoardStringPrint(&DeskTimeCtrl.Board,DeskWorkbarBuffer);
    //draw month
    BoardGotoxy(&DeskTimeCtrl.Board,1,9);
    BoardStringPrint(&DeskTimeCtrl.Board,(UINT8*)DeskWorkbarMonth);
    j=DeskWorkbarCtrl.CurrentTime.Month&0x7f;
    DeskWorkbarBuffer[0]='0'+((j&0xf0)>>4);
    DeskWorkbarBuffer[1]='0'+(j&0x0f);
    DeskWorkbarBuffer[2]=0;
    BoardStringPrint(&DeskTimeCtrl.Board,DeskWorkbarBuffer);
    //draw date
    BoardGotoxy(&DeskTimeCtrl.Board,1,17);
    BoardStringPrint(&DeskTimeCtrl.Board,(UINT8*)DeskWorkbarDate);
    j=DeskWorkbarCtrl.CurrentTime.Date;
    DeskWorkbarBuffer[0]='0'+((j&0xf0)>>4);
    DeskWorkbarBuffer[1]='0'+(j&0x0f);
    DeskWorkbarBuffer[2]=0;
    BoardStringPrint(&DeskTimeCtrl.Board,DeskWorkbarBuffer);
    //draw day
    BoardGotoxy(&DeskTimeCtrl.Board,1,25);
    BoardStringPrint(&DeskTimeCtrl.Board,(UINT8*)DeskWorkbarDay);
    j=DeskWorkbarCtrl.CurrentTime.Day;
    DeskWorkbarBuffer[0]='0'+((j&0xf0)>>4);
    DeskWorkbarBuffer[1]='0'+(j&0x0f);
    DeskWorkbarBuffer[2]=0;
    BoardStringPrint(&DeskTimeCtrl.Board,DeskWorkbarBuffer);
    //draw hour
    BoardGotoxy(&DeskTimeCtrl.Board,1,33);
    BoardStringPrint(&DeskTimeCtrl.Board,(UINT8*)DeskWorkbarHour);
    j=DeskWorkbarCtrl.CurrentTime.Hour&0x7f;
    DeskWorkbarBuffer[0]='0'+((j&0xf0)>>4);
    DeskWorkbarBuffer[1]='0'+(j&0x0f);
    DeskWorkbarBuffer[2]=0;
    BoardStringPrint(&DeskTimeCtrl.Board,DeskWorkbarBuffer);
    //draw minute
    BoardGotoxy(&DeskTimeCtrl.Board,1,41);
    BoardStringPrint(&DeskTimeCtrl.Board,(UINT8*)DeskWorkbarMinute);
    j=DeskWorkbarCtrl.CurrentTime.Minute;
    DeskWorkbarBuffer[0]='0'+((j&0xf0)>>4);
    DeskWorkbarBuffer[1]='0'+(j&0x0f);
    DeskWorkbarBuffer[2]=0;
    BoardStringPrint(&DeskTimeCtrl.Board,DeskWorkbarBuffer);
    //draw second
    BoardGotoxy(&DeskTimeCtrl.Board,1,49);
    BoardStringPrint(&DeskTimeCtrl.Board,(UINT8*)DeskWorkbarSecond);
    j=DeskWorkbarCtrl.CurrentTime.Second;
    DeskWorkbarBuffer[0]='0'+((j&0xf0)>>4);
    DeskWorkbarBuffer[1]='0'+(j&0x0f);
    DeskWorkbarBuffer[2]=0;
    BoardStringPrint(&DeskTimeCtrl.Board,DeskWorkbarBuffer);
}

VOID DeskWorkbarWindowListDraw(VOID)
{
    WINDOW *pWindow;
    WINDOW_TABLE *pTable;
    WINDOW_DEVICE *pDevice;
    EFI_GRAPHICS_OUTPUT_BLT_PIXEL *pMemory;
    UINT32 Height;
    UINT8 j = 0;

    if(DeskWorkbarCtrl.WindowListChange==FALSE) return;
    DeskWorkbarCtrl.WindowListChange=FALSE;
    //draw background color
    pWindow=&DeskWorkbarCtrl.Window;
    pTable=&DeskWorkbarCtrl.WindowListTable;
    pDevice=DeskWorkbarCtrl.WindowListTable.DeviceList;
    pMemory=DeskWorkbarCtrl.pWindowMemory+pTable->Area.Y*DESK_WORKBAR_WINDOWAREA_W+pTable->Area.X;
    Height=pTable->Area.H;
    while(Height!=0){
		UINT32 x_point, y_point;
		EFI_GRAPHICS_OUTPUT_BLT_PIXEL Color = Bmp2Rgb(GfxPaletteClut[pTable->Gfx.BgColor]); 
		x_point = pTable->Area.X;
		y_point = OsdCtrl.ScreenArea.H-DESK_WORKBAR_HEIGHT+pTable->Area.Y;
		PixelArraySet(pMemory, Color, pTable->Area.W);
		PixelArrayDraw(pMemory, x_point, y_point+j, pTable->Area.W, 1);
        pMemory=pMemory+DESK_WORKBAR_WINDOWAREA_W;
        Height--;j++;
    }        
    //draw window box    
    if(pDevice==(WINDOW_DEVICE *)NULL) return;
    while(pDevice!=(WINDOW_DEVICE *)NULL){
        DeskDeviceWindowboxDraw(DESK_DEVICE_DRAW_OSD,pWindow,pTable,(WINDOW_WINDOWBOX *)pDevice->pDevice);
        pDevice=pDevice->Next;
    }
}

VOID DeskWorkbarDraw(VOID)
{
    WINDOW *pWindow;
    WINDOW_TABLE *pTable;
    WINDOW_DEVICE *pDevice;

    pWindow=&DeskWorkbarCtrl.Window;
    pTable=DeskWorkbarCtrl.Window.UserTableList;
	
    while(pTable!=(WINDOW_TABLE *)NULL){
        DeskTableBackgroundDraw(DESK_DEVICE_DRAW_OSD,pWindow,pTable);
        pDevice=pTable->DeviceList;
        while(pDevice!=(WINDOW_DEVICE *)NULL){
            if(pDevice->Type==WINDOW_DEVICE_BUTTON)
                DeskDeviceButtonDraw(DESK_DEVICE_DRAW_OSD,pWindow,pTable,(WINDOW_BUTTON *)pDevice->pDevice);
            else if(pDevice->Type==WINDOW_DEVICE_STRINGBOX)
                DeskDeviceStringboxDraw(DESK_DEVICE_DRAW_OSD,pWindow,pTable,(WINDOW_STRINGBOX *)pDevice->pDevice);
            else if(pDevice->Type==WINDOW_DEVICE_WINDOWBOX)
                DeskDeviceWindowboxDraw(DESK_DEVICE_DRAW_OSD,pWindow,pTable,(WINDOW_WINDOWBOX *)pDevice->pDevice);
            pDevice=pDevice->Next;
        }
        pTable=pTable->Next;
    }
}

VOID DeskWorkbarWindowListPut(WINDOW *pWindow){
    DeskTableWindowDeviceAdd(&DeskWorkbarCtrl.WindowListTable,&pWindow->DeviceWindowBox);
    DeskWorkbarWindowListCalculate();
}

VOID DeskWorkbarWindowListDelete(WINDOW *pWindow){ //used in DeskWindowActiveWindowDelete
    WINDOW_DEVICE *pDevice,*pDevice2;

    if(DeskWorkbarCtrl.WindowListTable.DeviceList==(WINDOW_DEVICE *)NULL) return;
    pDevice=&pWindow->DeviceWindowBox;
    pDevice2=DeskWorkbarCtrl.WindowListTable.DeviceList;
    while(pDevice2!=(WINDOW_DEVICE *)NULL){
        if(pDevice==pDevice2){
            if(pDevice2==DeskWorkbarCtrl.WindowListTable.DeviceList){
                if(pDevice2->Next==(WINDOW_DEVICE *)NULL)
                    DeskWorkbarCtrl.WindowListTable.DeviceList=(WINDOW_DEVICE *)NULL;
                else{
                    DeskWorkbarCtrl.WindowListTable.DeviceList=pDevice2->Next;
                    pDevice2->Next->Prev=(WINDOW_DEVICE *)NULL;
                }
            }
            else{
                if(pDevice2->Next==(WINDOW_DEVICE *)NULL){
                    pDevice2->Prev->Next=(WINDOW_DEVICE *)NULL;
                }
                else{
                    pDevice2->Prev->Next=pDevice2->Next;
                    pDevice2->Next->Prev=pDevice2->Prev;
                }
            }
            break;
        }
        pDevice2=pDevice2->Next;
    }
    DeskWorkbarWindowListCalculate();
}

VOID DeskWorkbarWindowListDelete2(WINDOW *pWindow){ //used in other task
    WINDOW_DEVICE *pDevice,*pDevice2;
    
    //OsEnterCritical?? no need because mother function has called
    if(DeskWorkbarCtrl.WindowListTable.DeviceList==(WINDOW_DEVICE *)NULL) return;
    pDevice=&pWindow->DeviceWindowBox;
    pDevice2=DeskWorkbarCtrl.WindowListTable.DeviceList;
    while(pDevice2!=(WINDOW_DEVICE *)NULL){
        if(pDevice==pDevice2){
            if(pDevice2==DeskWorkbarCtrl.WindowListTable.DeviceList){
                if(pDevice2->Next==(WINDOW_DEVICE *)NULL)
                    DeskWorkbarCtrl.WindowListTable.DeviceList=(WINDOW_DEVICE *)NULL;
                else{
                    DeskWorkbarCtrl.WindowListTable.DeviceList=pDevice2->Next;
                    pDevice2->Next->Prev=(WINDOW_DEVICE *)NULL;
                }
            }
            else{
                if(pDevice2->Next==(WINDOW_DEVICE *)NULL){
                    pDevice2->Prev->Next=(WINDOW_DEVICE *)NULL;
                }
                else{
                    pDevice2->Prev->Next=pDevice2->Next;
                    pDevice2->Next->Prev=pDevice2->Prev;
                }
            }
            break;
        }
        pDevice2=pDevice2->Next;
    }
    DeskWorkbarWindowListCalculate();
}

VOID DeskWorkbarWindowListCalculate(VOID){
    WINDOW_DEVICE *pDevice;
    UINT8 i;
    
    i=0;
    pDevice=DeskWorkbarCtrl.WindowListTable.DeviceList;
    while(pDevice!=(WINDOW_DEVICE *)NULL){
        if((1+(i+1)*(WINDOW_BOX_WIDTH+1))<DeskWorkbarCtrl.WindowListTable.Area.W){
            ((WINDOW_WINDOWBOX *)(pDevice->pDevice))->Area.X=1+(i*(WINDOW_BOX_WIDTH+1));
            ((WINDOW_WINDOWBOX *)(pDevice->pDevice))->Area.Y=1;
            ((WINDOW_WINDOWBOX *)(pDevice->pDevice))->Area.W=WINDOW_BOX_WIDTH;
            ((WINDOW_WINDOWBOX *)(pDevice->pDevice))->Area.H=WINDOW_BOX_HEIGHT;
        }
        else{
            ((WINDOW_WINDOWBOX *)(pDevice->pDevice))->Area.X=DeskWorkbarCtrl.WindowListTable.Area.W;
            ((WINDOW_WINDOWBOX *)(pDevice->pDevice))->Area.Y=DeskWorkbarCtrl.WindowListTable.Area.H;
            ((WINDOW_WINDOWBOX *)(pDevice->pDevice))->Area.W=0; // no area size
            ((WINDOW_WINDOWBOX *)(pDevice->pDevice))->Area.H=0; // no area size
        }
        i++;
        pDevice=pDevice->Next;
    }
}

BOOLEAN DeskWorkbarDirtyCheck(VOID){
    WINDOW *pWindow;
    WINDOW_TABLE *pTable;
    WINDOW_DEVICE *pDevice;
    
    pWindow=&DeskWorkbarCtrl.Window;
    pTable=DeskWorkbarCtrl.Window.UserTableList;
    while(pTable!=(WINDOW_TABLE *)NULL){
        pDevice=pTable->DeviceList;
        while(pDevice!=(WINDOW_DEVICE *)NULL){
            if(DeskDeviceDirtyCheck(pDevice)==TRUE){
                DeskWorkbarCtrl.Window.Dirty=TRUE; 
                return TRUE;
            }
            pDevice=pDevice->Next;
        }
        pTable=pTable->Next;
    }
    DeskWorkbarCtrl.Window.Dirty=FALSE; 
    return FALSE;
}
